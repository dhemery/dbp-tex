\def\facingpages{
  \hoffset=\leftmargin
  \shipout\page
  \userunningpageframe
  \advancepageno
}

\def\page{
  \vbox{
    \headline
    \textblock
    \footline
  }
}

\def\textblock{
  \vbox to \vsize{
    \boxmaxdepth=\maxdepth
    \unvbox255
  }
}

\def\balancedspreads{
  \facingpages
}

\def\headline{\vbox to 0pt{\positionhead\line{\the\head}\vss\nointerlineskip}}
\def\footline{\vbox to 0pt{\positionfoot\line{\hbox to 0pt{\style{runninghead}\routinename\hss}\the\foot}\vss\nointerlineskip}}
\def\positionhead{\vskip.33333\leading\vskip-\headskip}
\def\positionfoot{\vskip-1.33333\leading\vskip\footskip}

\def\setoutput#1{
  \output={#1}
  \gdef\routinename{\string#1}
}
