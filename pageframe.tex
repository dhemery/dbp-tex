\newtoks\head
\newtoks\foot
% Place head two lines above first baseline
\newdimen\headskip \headskip=2\leading
% Place foot two lines below the textblock's last baseline
\newdimen\footskip \footskip=2\leading

\def\headline{\vbox to 0pt{\positionhead\line{\the\head}\vss\nointerlineskip}}
\def\footline{\vbox to 0pt{\positionfoot\line{\the\foot}\vss\nointerlineskip}}
\def\positionhead{\vskip.33333\leading\vskip-\headskip}
\def\positionfoot{\vskip-1.33333\leading\vskip\footskip}

\def\runninghead{\line{}}
\def\runningfoot{\line{}}
\def\useclearedframethispage{\global\head={\clearedhead}\global\foot={\clearedfoot}}
\def\usedisplayframethispage{\global\head={\displayhead}\global\foot={\displayfoot}}
\def\userunningpageframe{\global\head={\runninghead}\global\foot={\runningfoot}}

% Running head and foot for cleared pages
% (pages begun by \nextpage, \nextoddpage, and \nextevenpage).
% You may want to change these for debugging.
\def\clearedhead{\line{}}
\def\clearedfoot{\line{}}

% Running head and foot for display pages
% (pages that begin with a major display item such as a part or chapter title)
\def\displayhead{\line{}}
\def\displayfoot{\style{runningheader}\sc\hfil\folio\hfil}

% Running head and foot after user calls \useemptypageframe.
% By default, this format uses empty frames for frontmatter and backmatter pages.
% You may want to change these for debugging.
\def\emptyhead{\line{}}
\def\emptyfoot{\line{}}

% Running head and foot for most content pages.
% We use different heads on even and odd pages.
% Redefine to suit your formatting needs.
\def\normalhead{\style{runningheader}\sc\ifodd\pageno\normaloddpagehead\else\normalevenpagehead\fi}
% No foot on normal pages
\def\normalfoot{\line{}}
% Odd (right) pages: title at inner margin, page number at outer margin
\def\normaloddpagehead{\style{runningheader}\sc\title\hfil\folio}
% Even (left) pages: page number at outer margin, author name at inner margin
\def\normalevenpagehead{\style{runningheader}\sc\folio\hfil\author}

\def\useemptypageframe{
  \gdef\runninghead{\emptyhead}
  \gdef\runningfoot{\emptyfoot}
  \userunningpageframe
}

\def\usenormalpageframe{
  \gdef\runninghead{\normalhead}
  \gdef\runningfoot{\normalfoot}
  \userunningpageframe
}
