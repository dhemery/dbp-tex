\newtoks\headline
\newtoks\footline
\newdimen\headlineskip % Distance from textblock first baseline to top of headline
\newdimen\footlineskip % Distance from textblock last baseline to footline baseline

\def\makeheadline{\vbox to 0pt{\positionheadline\line{\the\headline}\vss\nointerlineskip}}
\def\makefootline{\vbox to 0pt{\positionfootline\line{\the\footline}\vss\nointerlineskip}}
\def\positionheadline{\vskip.33333\leading\vskip-\headlineskip}
\def\positionfootline{\vskip-1.33333\leading\vskip\footlineskip}

\def\runningheadline{\line{}}
\def\runningfootline{\line{}}
\def\useclearedframethispage{\global\headline={\clearedheadline}\global\footline={\clearedfootline}}
\def\usedisplayframethispage{\global\headline={\displayheadline}\global\footline={\displayfootline}}
\def\userunningpageframe{\global\headline={\runningheadline}\global\footline={\runningfootline}}

% Running headline and footline for cleared pages
% (pages begun by \nextpage, \nextoddpage, and \nextevenpage).
% You may want to change these for debugging.
\def\clearedheadline{\line{}}
\def\clearedfootline{\line{}}

% Running headline and footline for display pages
% (pages that begin with a major display item such as a part or chapter title)
\def\displayheadline{\line{}}
\def\displayfootline{\style{runningheader}\sc\hfil\folio\hfil}

% Running headline and footline after user calls \useemptypageframe.
% By default, this format uses empty frames for frontmatter and backmatter pages.
% You may want to change these for debugging.
\def\emptyheadline{\line{}}
\def\emptyfootline{\line{}}

% Running headline and footline for most content pages.
% We use different headlines on even and odd pages.
% Redefine to suit your formatting needs.
\def\normalheadline{\style{runningheader}\sc\ifodd\pageno\normaloddpageheadline\else\normalevenpageheadline\fi}
% No footline on normal pages
\def\normalfootline{\line{}}
% Odd (right) pages: title at inner margin, page number at outer margin
\def\normaloddpageheadline{\style{runningheader}\sc\title\hfil\folio}
% Even (left) pages: page number at outer margin, author name at inner margin
\def\normalevenpageheadline{\style{runningheader}\sc\folio\hfil\author}

\def\useemptypageframe{
  \gdef\runningheadline{\emptyheadline}
  \gdef\runningfootline{\emptyfootline}
  \userunningpageframe
}

\def\usenormalpageframe{
  \gdef\runningheadline{\normalheadline}
  \gdef\runningfootline{\normalfootline}
  \userunningpageframe
}
