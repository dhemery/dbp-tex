\newtoks\head
\newtoks\foot
\newdimen\headskip
\newdimen\footskip

\def\headline{\vbox to 0pt{\kern-\headskip\line{\vbox to \topskip{}\runningheadtype\the\head}\vss}\nointerlineskip}
\def\footline{\baselineskip=\footskip \lineskiplimit=0pt \line{\runningheadtype\the\foot}}

\def\runninghead{\line{}}
\def\runningfoot{\line{}}
\def\useclearedframethispage{\global\head={\clearedhead}\global\foot={\clearedfoot}}
\def\usedisplayframethispage{\global\head={\displayhead}\global\foot={\displayfoot}}
\def\useemptyframethispage{\global\head={\emptyhead}\global\foot={\emptyfoot}}
\def\userunningpageframe{\global\head={\runninghead}\global\foot={\runningfoot}}

% Running head and foot for cleared pages
% (pages begun by \nextpage, \nextrectopage, and \nextversopage).
% You may want to change these for debugging.
\def\clearedhead{\line{}}
\def\clearedfoot{\line{}}

% Running head and foot for display pages
% (pages that begin with a major display item such as a part or chapter title)
\def\displayhead{\line{}}
\def\displayfoot{\hfil\the\folio\hfil}

% Running head and foot after user calls \useemptypageframe.
% By default, this format uses empty frames for frontmatter and backmatter pages.
% You may want to change these for debugging.
\def\emptyhead{\line{}}
\def\emptyfoot{\line{}}

% Running head and foot for most content pages.
% We use different heads on even and odd pages.
% Redefine to suit your formatting needs.
\def\normalhead{\ifodd\pageno \normalrectopagehead\else\normalversopagehead\fi}
% No foot on normal pages
\def\normalfoot{\line{}}
% Recto pages: title at spine margin, page number at edge margin
\def\normalrectopagehead{\the\title\hfil\the\folio }
% Verso pages: page number at edge margin, author name at spine margin
\def\normalversopagehead{\the\folio\hfil\the\author}

\def\useemptypageframe{
  \gdef\runninghead{\emptyhead}
  \gdef\runningfoot{\emptyfoot}
  \userunningpageframe
}

\def\usenormalpageframe{
  \gdef\runninghead{\normalhead}
  \gdef\runningfoot{\normalfoot}
  \userunningpageframe
}

\def\fitpageframe{
  \global\headskip=2\leading
  \global\footskip=2\leading
}
